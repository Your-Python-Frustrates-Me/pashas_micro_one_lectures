# Лекция 2, часть 1

## Линейное бюджетное ограничение

Для простоты, рассмотрим два товара $x, y$, как обычно, в $\mathbb{R}^2_{+}$. Обозначим цены этих двух товаров как $p, q$.  Если бюджет агента составляет $I>0$, то бюджетное ограничение представляется полуплоскостью: 

$$ B(x,y) = p x + q y - I \leqslant 0$$ 

которая, в пересечении с $\mathbb{R}^2_{+}$ дает прямоугольный треугольник. Сразу оговорюсь, что **цены будут всегда неотрицательные** и, по большей части, даже строго положительные.

Пусть горизонтальная ось соответствует товару $х$. Тогда координаты вершин треугольника находятся как пересечение гипотенузы с осями: $(\frac{I}{p}, 0)$ и $(0, \frac{I}{q})$. Чаще всего мы будем иметь дело именно с таким бюджетным ограничением, поэтому потренируйтесь быстро рисовать его по вершинам. Постарайтесь также ответить на следующие вопросы.

*Вопрос 1: Является ли такое бюджетное ограничение выпуклым?*

Попробуйте ответить самостоятельно...

*Вопрос 2: Как меняется бюджетное ограничение при увеличении цены товара $x$?*

Поскольку координата соответствующего (правого нижнего) угла треугольника стремится к нулю, то треугольник уменьшается за счет "поворота" гипотенузы вокруг противоположной вершины.

*Вопрос 3: Как меняется бюджетное ограничение при увеличении бюджета $I$?*

Поскольку координаты обеих вершин увеличиваются пропорционально, то гипотенуза "отъезжает" в сторону противоположную началу координат.

*Вопрос 4: Повторите все рассуждения для трех товаров x, y, z в $\mathbb{R}^3_{+}$.*

... вместо треугольника будет эдакая пирамида, а для произвольного числа товаров это множество называется **симплекс** в $\mathbb{R}^n$. 

## Метод Лагранжа

Метод (Множителей) Лагранжа своими корнями уходит в физику и был разработан, в первую очередь, для решения выпуклых оптимизационных задач. Однако, даже если задача не выпуклая, анализ все равно можно проводить на языке Лагранжа, пусть и с оговорками. Таким образом, существует две основные интерпретации метода: выпуклая и невыпуклая. 

Предположим, что наше бюджетное ограничение 

$$B(x,y) = p x + q y - I \leqslant 0$$ 

а функция $U(x, y)$ - непрерывная. Мы хотим промаксимизировать эту полезность на бюджетном ограничении: 

$$U(x,y) \to \max_{x, y \in \mathbb{R}_{+}^2}, \quad s.t. \quad B(x,y) \leqslant 0.$$

### Собственно метод

Mетод Лагранжа заключается в выписывании новой функции, называемой Лагранжианом. Она зависит от всех переменных, по которым мы оптимизируем, но также обладает новыми переменными, называемыми множителями Лагранжа, по одному на каждое (существенное) ограничение: 

$$ \mathcal{L} (x, y| \lambda) = U(x,y) - \lambda B(x, y).$$ 

Если есть сомнения в том, что решения не осях, надо выписать более общий Лагранжиан:

$$ \mathcal{L} (x, y| \lambda, \gamma, \delta) = U(x,y) - \lambda B(x, y)  + \gamma x + \delta y,$$ 

поскольку $x \geqslant 0$ и $y \geqslant 0$ это тоже ограничения. Но до этого, как правило, не доходит, потому что в экономических приложениях решение, как правило, внутреннее. 

Далее, предлагается найти экстремум Лагранжиана по всем переменным, включая множители Лагранжа, то есть, надо решить следующую систему уравнений: 

$$\nabla_{(x,y)} \mathcal{L} = 0, \quad \nabla_{\lambda} \mathcal{L} = 0.$$

Затем, возможно, провести анализ второго порядка, то есть, среди полученных кандидатов отобрать те, для которых $\nabla^2 \mathcal{L}_{(x,y)} \leqslant 0$ на касательном к ограничению пространстве.

Как это вообще связано с оригинальной задачей, вообще говоря, не совсем понятно. 

### Выпуклая интерпретация

Выпуклая интерпретация метода Лагранжа, также называемая **Сильным Принципом Лагранжа** или **Сильная Дуальность** или **Теорема о Минимаксе**, была сформулирована Вон Нейманом - американским математиком Венгерского происхождения в 1928 году и существенно повлияло на развитие экономической мысли.

:::{admonition} **Minimax Theorem**
:class: warning
Значение задачи оптимизации с ограничением (левая часть) связано со значением некоторой дуальной задачи (правая часть):

$$ \min_{\lambda \geqslant 0} \max_{x,y \geqslant 0} \mathcal{L}(x,y | \lambda) =  \max_{x,y \geqslant 0} \min_{\lambda \geqslant 0} \mathcal{L}(x,y | \lambda) $$ 

если только задача выпукла, то есть, ограничения выпуклы а функция вогнута или квази-вогнута. Более того, их экстремумы совпадают, но правую задачу решать намного приятнее.

:::

Поиск экстремума (конкретно седла) правой задачи как раз характеризуется решением системы уравнений 

$$\nabla_{(x,y)} \mathcal{L} = 0, \quad \nabla_{\lambda} \mathcal{L} = 0.$$

Никаких условий второго порядка проверять не надо, потому что задача уже выпукла, по построению. Чтобы проверить себя, попробуйте ответить на следующие вопросы.

*Вопрос 1: Когда Лагранжиан является выпуклым по $x,y$?*

*Вопрос 2: Если $U(x,y)$ не вогнута но квази-вогнута, что делать?*

### Невыпуклая интерпретация

Совершенно независимо, была разработана более общая (но и более муторная) технология решения невыпуклых задач оптимизации, начиная с 1939 года, и носящая имя сразу трех математиков: Каруш, Кун и Такера. Вам она, скорее всего известна как **Условия Первого Порядка** и **Условия Второго Порядка**.

:::{admonition} **KKT Theorem**
:class: warning
В гладкой задаче оптимизации, экстремальные точки характеризуются тем, что градиенты ограничений и самой функции линейно зависимы (а в случае 1 ограничения сонаправлены), то есть: 

$$ \nabla_{(x,y)} U -  \lambda \cdot \nabla_{(x,y)}B = 0$$ 

:::

Это мистическим образом совпадает с условием на экстремум Лагранжиана. Отсюда Условия первого Порядка и Метод Множителей Лагранжа.

A Условия Второго Порядка при линейном ограничении упрощаются до 

$$ \nabla^2_{(x,y)} U - \lambda \cdot \nabla^2_{(x,y)}B \leqslant 0$$ 

на касательном к ограничении пространстве. 

*Вопрос 3: Убедитесь, что проверка Условия Второго Порядка совпадает с проверкой квази-вогнутости функции $U$ в экстремальной точке.*

*Вопрос 4: Как вы думаете, может ли быть так что Условия Второго Порядка выполнены, но при этом функция не квази-вогнутая?.*

### Интерпретация множителя Лагранжа

У множителя Лагранжа есть специальная экономическая интерпретация. 

Давайте интерпретировать $B(x,y) = px + qy - I$ как перерасход бюджетных средств. Тогда Лагранжиан имеет вид:

$$ \mathcal{L} (x, y| \lambda) = U(x,y) - \lambda B(x,y),$$ 

и множитель Лагранжа $\lambda$ интерпретируется как **теневая цена** нарушения бюджетного ограничения. То есть, мы как бы "покупаем" возможность перерасхода бюджетных средств по цене $\lambda$. 

Если, по какой то причине, у одного из товаров есть нетривиальная квота $x \leqslant \bar x$ то Лагранжиан будет такой: 

$$ \mathcal{L} (x, y| \lambda, \gamma) = U(x,y) - \lambda B(x,y) - \gamma (x - \bar x),$$ 

и множитель Лагранжа $\gamma$ интерпретируется как **теневая цена** дополнительной единицы  товара $x$ сверх квоты. То есть, мы как будто покупаем его на черном рынке по цене $\gamma$.

## Функции спроса

> Назовем **функциями спроса** $x^{\ast}(p, q, I), y^{\ast}(p, q, I)$ решение задачи максимизации полезности при бюджетном ограничении:

$$U(x,y) \to \max_{x, y \in \mathbb{R}_{+}^2}, \quad s.t. \quad B(x,y) = p x + q y -I \leqslant 0.$$

Функция спроса на первый товар $x^{\ast}(p, q, I)$ и на второй товар $y^{\ast}(p, q, I)$ зависят от трех разных параметров: своей цены, чужой цены и бюджета. Чаще всего нас будут интересовать 

- кривые "цена-потребление" $x^{\ast}(p, \ldots)$, $y^{\ast}(q, \ldots)$, обычно называемые просто **кривые спроса**.
- кривые "доход-потребление" $x^{\ast}(I, \ldots)$, $y^{\ast}(I, \ldots)$, также называемые **кривые Энгеля** в честь немецкого статистика Эрнста Энгеля (Engel).

### Нормальные и инфериорные товары

В этот раз обойдемся без великих людей. 

> **Нормальными товарами** называются товары, кривые спроса которых монотонно возрастают по доходу, то есть, $x$ нормальный, если 

$$\frac{\partial x^{\ast}}{\partial I} \geqslant 0.$$

Проверка нормальности при аккуратно выведенных кривых спроса - это механическое упражнение в дифференцировании.  

Считается, что большая часть товаров - нормальны, однако есть исключения. Например, хлеб, рис, консервы и другие "товары первой необходимости" иногда интерпретируются как худшими (инфериорными) по отношению к красному мясу, рыбе, овощам и фруктам. 

> Товар у которого нормальность нарушается хотя бы при каких то значениях параметров то есть, 

$$\frac{\partial x^{\ast}}{\partial I} < 0,$$ 

называется **инфериорным** (при этих значениях параметров). 

Инфериорность, от английского *inferior*, означает что ваш товар $x$ является худшим по отношению к какому то другому товару $y$. Когда бюджет растет, вы тратите большую часть дохода на $y$, и меньшую на $x$, да так что в абсолютном значении потребление $x$ уменьшается. Для того, чтобы сломать нормальность $x$, обязательно должен быть хотя бы один не инфериорный товар $y$, по отношению к которому $x$ будет инфериорным.

> Утверждение 1: Все товары не могут быть одновременно инфериорными, хотя бы один точно нормальный.

Доказать это утверждение очень легко. Если бюджетное ограничение таково, что оптимум находится "внутри", то небольшое изменение параметра $I$ не повлияет на оптимум. Если бюджетное ограничение таково, что оптимум находится "на бюджетной линии", то дифференциируя $B(x,y)= 0$ по $I$ мы получаем: 

$$ p \frac{\partial x^{\ast}}{\partial I}  + q \frac{\partial y^{\ast}}{\partial I}  = 1.$$ 

Поскольку цены неотрицательные, то инфериорность всех товаров означает, что слева стоит отрицательное число, а справа единица. Противоречие.

*Вопрос 5: Убедитесь, что кривая Энгеля у нормальных товаров всегда неубывает*

*Вопрос 6: Придумайте жизненный пример товара, у которого кривая Энгеля выходит на плато.*

*Вопрос 7: Придумайте аргументы за и против того, что общественный транспорт является инфериорным благом.*

### Субституты и комплементы

Мы продолжаем исследовать свойства кривых спроса. Одним из самых важных понятий в теории потребителя является **замещаемость** (substitutability). Считается, что многие товары в той или иной степени замещаемы, некоторые больше некоторые меньше. Некоторые пары товаров особенно выделяются в этом плане, например: пепси и кола, лыжи и сноуборд... Если цена одного такого товара в паре сильно вырастет, то спрос на второй товар скорее всего вырастет. Такие товары называются субститутами.

> **Субститутами** (substitutes) называются пары товаров, кривые спроса которых монотонно возрастают по ценам друг друга, то есть, $x$ субститут к $y$, если $\frac{\partial x^{\ast}}{\partial q} \geqslant 0,$ a $y$ субститут к $x$, если $\frac{\partial y^{\ast}}{\partial p} \geqslant 0.$

У некоторых пар товаров наблюдается прямо противоположное свойство, их обычно покупают вместе, например: кайак и весло, компьютер и монитор...  Если цена одного такого товара в паре сильно вырастет, то спрос на второй товар скорее всего упадет. Такие товары называются комплементами.

> **Комплементами** (complements) называются пары товаров, кривые спроса которых монотонно убывают по ценам друг друга, то есть, $x$ комплемент к $y$, если $\frac{\partial x^{\ast}}{\partial q} < 0,$ a $y$ комплемент к $x$, если $\frac{\partial y^{\ast}}{\partial p} < 0.$

К сожалению, это свойство не является симметричным, то есть, $x$ может быть субститутом к $y$, но y при этом может оказаться комплементом к $x$, хоть и в очень редких случаях. Это сигнализирует нам о том, что определение выбрано не совсем удачно, но какое то время нам придется с этим противоречием смириться.

