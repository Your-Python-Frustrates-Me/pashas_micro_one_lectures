(forms)=
# Квадратичные формы

С точки зрения пользователя, **квадратичная форма** это просто квадратная матрица, которая является при этом также симметричной. В нашем курсе такие матрицы появятся при повторном дифференциировании гладких функций, то есть, при выписывания Гессиана.

Пусть, к примеру у нас есть фунция $f(x, y) = x^2 y + x + y$ 

Тогда градиент равен:

$$ \nabla f = \begin{pmatrix} \frac{\partial f}{\partial x}\\ \frac{\partial f}{\partial y}\end{pmatrix} = \begin{pmatrix} 2 x y + 1\\ x^2 + 1\end{pmatrix}$$

а Гессиан равен:

$$ \nabla^2 f = \begin{pmatrix} \frac{\partial^2 f}{\partial^2 x} & \frac{\partial^2 f}{\partial x \partial y} \\ \frac{\partial^2 f}{\partial y \partial x} & \frac{\partial^2 f}{\partial^2 y}\end{pmatrix} = \begin{pmatrix} 2 y & 2 x \\ 2 x & 0\end{pmatrix}$$

Квадратичная форма применяется к векторам и выдает обычные числа. Например, если вектор равен $v=(a, b)$, тогда

$$\nabla^2 f (v) = \begin{pmatrix} a & b \end{pmatrix} \begin{pmatrix} 2 y & 2 x \\ 2 x & 0\end{pmatrix} \begin{pmatrix} a \\ b \end{pmatrix}$$

Перемножая все три матрицы вручную, мы получаем:

$$\nabla^2 f (v) = a^2 \cdot 2 y + a b \cdot x y + b^2 \cdot 0.$$

Это функция от координат вектора $v = (a,b)$, а $x, y$ это параметры. Довольно легко подогнать параметры так, чтобы значение функции было гарантированно полоэительным или гарантированно отрицательным на всех векторах $v$, отличных от нуля.

Например, если $x = 0, y = 1$ то форма положительно определена и мы пишем $\nabla^2 f > 0$. Если же $x = 0, y = -1$ то форма отрицательно определена и мы пишем $\nabla^2 f < 0$.

## Критерий Сильвестра

### Вогнутость

Рассмотрим гессиан функции от 3 переменных

$$
\nabla^2 f = \begin{pmatrix} 
f''_{xx} & f''_{xy} & f''_{xz} \\
f''_{yx} & f''_{yy} & f''_{yz} \\
f''_{zx} & f''_{zy} & f''_{zz}
\end{pmatrix}
$$

У этой матрицы, как и у любой другой, есть главные миноры:

$$ \Delta_1 = f''_{xx}, \quad \Delta_2 = f''_{xx}f''_{yy}-(f''_{xy})^2, \quad \ldots$$

являющиеся определителями расширяющихся матриц, начиная с левого верхнего угла.

Необходимым условием для вогнутости функции является то, что главные миноры имеют чередующиеся знаки, начиная с первого, который должен быть (нестрого) отрицательным:

$$ \Delta_1 \leqslant 0, \quad \Delta_2 \geqslant 0, \quad \Delta_3 \leqslant 0,  \quad \ldots$$

Достаточным условием для вогнутости функции является то, что главные миноры имеют чередующиеся знаки, начиная с первого, который должен быть (строго) отрицательным:

$$ \Delta_1 < 0, \quad \Delta_2 > 0, \quad \Delta_3 < 0, \quad \ldots$$

### Квази вогнутость

Для анализа квази вогнутости, нужно заменить гессиан на окаймленный гессиан, у которого сверху и слева приставлен градиент функции в точке, а в левом верхнем углу еще стоит ноль.

$$
\begin{pmatrix} 
0 & f'_{x} & f'_{y} & f'_{z} \\
f'_{x} & f''_{xx} & f''_{xy} & f''_{xz} \\
f'_{y} & f''_{yx} & f''_{yy} & f''_{yz} \\
f'_{z} & f''_{zx} & f''_{zy} & f''_{zz}
\end{pmatrix}
$$

Миноров тут будет на один больше чем в не окаймленном случае:

$$ \Delta_1 = (-f'_{x})^2, \quad \ldots$$

являющиеся определителями расширяющихся матриц, начиная с левого верхнего угла.

Необходимым условием для квази вогнутости функции является то, что главные миноры имеют чередующиеся знаки, начиная с первого, который должен быть (нестрого) отрицательным:

$$ \Delta_1 \leqslant 0, \quad \Delta_2 \geqslant 0, \quad \Delta_3 \leqslant 0,  \quad \ldots$$

Достаточным условием для квази вогнутости функции является то, что главные миноры имеют чередующиеся знаки, начиная с первого, который должен быть (строго) отрицательным:

$$ \Delta_1 < 0, \quad \Delta_2 > 0, \quad \Delta_3 < 0, \quad \ldots$$