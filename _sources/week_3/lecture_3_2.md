# Лекция 3, часть 2

Пусть есть, для простоты, два товара. Как обычно, будем обозначать их (и их спросы) как $x,y$ а соответствующие цены как $p,q$.

## Тождество Роя

Мы хотим связать между собой три объекта: $x^{\ast}(p,q,I), y^{\ast}(p,q,I)$ и  $V^{\ast}(p,q,I)$. Для этого мы воспользуемся фундаментальным свойством, что косвенная полезность это полезность, в которую подставили спросы:

$$V(p, q, px + qy) = U(x, y),$$

Убедитесь, что это, действительно, корректная запись.

Что можно сделать с этим тождеством?

- продифференциировать по $p$
- продифференциировать по $q$

Заметим, что цены входят слева дважды, а справа не входят вообще. То есть, с точки зрения дифференциирования по ценам, справа стоит константа, а слева сложная функция. По правилам дифференциирования, полный дифференциал функции $V$ по $p$ равен:

$$ 
\begin{gather*}
\frac{d V}{d p} = \frac{\partial V}{\partial p} + \frac{\partial V}{\partial I} \cdot \frac{\partial I}{\partial p} = 0
\end{gather*}
$$

:::{seealso}
[Прочитайте, если вы не понимаете разницу между частным и полным дифференциалом.](differentials)
:::


Поскольку $\frac{\partial I}{\partial p} = x$, 

$$\frac{d V}{d p} = \frac{\partial V}{\partial p} + \frac{\partial V}{\partial I} \cdot x = 0$$


Aналогично для остальных цен, мы пришли к:

:::{prf:theorem} Тождество Роя
:class: remark
Если $\vec{x}$ - весь вектор спросов, а $\vec{p}$ - весь вектор цен то

$$\vec{x} = - \nabla_{\vec{p}} V / \nabla_I V$$

:::

Заметьте, что я меняю интерпретацию знаков $x, p$ в зависимости от контекста. К этому надо привыкать, контекст задачи важен. Например, $\nabla$ обычно означает вектор, но в знаменателе $\nabla_I = \frac{\partial V}{\partial I}$ это число, потому что $I$ это скаляр.

### Зачем оно нужно?

У тождества Роя есть две основные задачи. 

Во первых, ваши эконометрические данные могут быть в терминах косвенной полезности а не бюджетов. Например, в социальном опросе может быть вопрос: "оцените по шкале от 1 до 10 ваше благосостояние в 2010, 2011 и 2012 году", вместо "запишите ваш доход в 2010, 2011 и 2012 году". Считается, что люди неохотно сообщают свои настоящий доход, богатые занижают а бедные завышают.

Во вторых, иногда проще запомнить косвенную полезность и вывести из нее спросы, чем запоминать спросы. Также, про косвенную полезность удобно составлять задачи, чтобы потом тестировать вас на экзамене.

## Теорема об Огибающей

Это чрезвычайно важная Теорема, и, в отличие от остальных, по настоящему полезная. 

Рассмотрим семейство опорных функций $f(x, p)$, где $x$ - переменная а $p$ - параметр. Определим огибающую $V(p)$ как результат оптимизации функции $f$ по какому-то статическому множеству $Х$: 

$$ V(p) := \max_{x \in Х} f(x, p),$$

тогда...

:::{prf:theorem}
:class: remark

Функция $V(p)$ (почти всюду) дифференциируема и 

$$\frac{\partial V(p)}{\partial p} = \frac{\partial f(x, p)}{\partial p}|_{x = x^{\ast}(p)}.$$

:::

... то есть, наклон огибающей в точке касания равен наклону соответствующей опорной функции в этой точке.

### Интуиция огибающей

Представьте себе, что вы свалили в кучу какие то крупные объекты и накрыли все эластичной пленкой. 

Пленка плотно прилегла к тем объектам, которые оказались наверху. Можно сказать, что пленка - это (верхняя) огибающая вашего семейства опорных объектов, поскольку она лежит там, где находится самый высокий объект в каждой точке. 

Теперь посмотрим на нашу эластичную пленку. В точках касания с теми опорными объектами что остановили ее от падения, наклон пленки равен наклону этих объектов, так как она повторяет их форму.

Этот практиически умозрительный факт и есть основная идея Теоремы об Огибающей: **наклон огибающей функции в точке касания равен наклону (соответствующей) опорной функции**.

### Примеры

:::{prf:example}

$$ 
\begin{gather*}
a = V(a) = \max_x a-(x-a)^2 \Rightarrow \\
\frac{\partial V(a)}{\partial a} = 1 + 2(x-a)|_{x = a} = 1
\end{gather*}
$$

:::

:::{prf:example}


$$ 
\begin{gather*}
a = V(a,b,c) = \max_{x,y} a-a(x-b)^2 - (y-c)^2 \Rightarrow \\
\frac{\partial V(a, b, c)}{\partial a} = 1 + 2a(x-b)|_{x = b} + 2(y-c)|_{y = c} = 1 
\end{gather*}
$$


:::

### Практическая польза

Может показаться, что дифференцирование опорной функции и подстановка это лишняя трата времени, ведь можно просто решить задачу и продифференцировать $V$ по параметру, в лоб.

Это правда, однако, если у вас абстрактная функция, вы не можете просто так ее промаксимизировать. Поэтому, эта теорема очень удобна при доказательствах, но не только. 

Зачастую, видение огибающей позволяет сэкономить время при дифференцировании, в том смысле, что вам не надо лишний раз протаскивать производную по правилу дифференциирования сложной функции.

К примеру, предположим, что у вас есть функция $F(x, y, p)$ и eще две функции $x = g(p), y = h(p)$. Если вас попросят найти полную производную $F(х(p), y(p), p)$ по $p$ то получится:

$$\frac{d}{dp} F(х(p), y(p), p) = \frac{\partial F}{\partial x} \frac{\partial x}{\partial p} + \frac{\partial F}{\partial y} \frac{\partial y}{\partial p} + \frac{\partial F}{\partial p}.$$

Теперь предположим, что нам стало известно, что $x = g(p), y = h(p)$ это, на самом деле, оптимумы функции $F$. Тогда, по Теореме об Огибающей

$$\frac{d}{dp} F(х(p), y(p), p) = \frac{\partial F}{\partial p}.$$

Получается, что Теорема об Огибающей позволяет нам **игнорировать параметр находящийся внутри оптимальной точки** при подсчете полного дифференциала. Это знание позволяет в отдельных упражнениях сэкономить 10-20 минут изнурительных вычислений.

### Как насчет косвенной полезности

Для того, чтобы активировать всю мощь Теоремы об Огибающей, вам достаточно взять любую функцию, которая является результатом оптимизации и продифференциировать ее по любому параметру.

К примеру, мы могли бы продифференциировать косвенную полезность по ценам. Тогда Теорема об Огибающей даст вам связь этих производных с производными опорной функции в точках оптимума.

:::{dropdown} А что есть опорная функция для косвенной полезности $V(p,q,I)$?
Хочется сказать что сама полезность $U(x,y)$ но правильный ответ это Лагранжиан 

$$\mathcal{L}=U(x,y) - \lambda(px + qy - I)$$

по крайней мере он подходит формально, так как зависит от $p,q,I$.
:::

Любопытным также является факт, что теорема об огибающей позволяет найти производную косвенной полезности по бюджету. 

:::{dropdown} Чему она равна?

Множителю Лагранжа $\lambda$, она же **теневая цена** ослабления бюджета.
:::

## Минимизация расходов

## Возвращение к CES