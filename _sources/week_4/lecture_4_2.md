# Четвертая лекция, часть 2

## Матрица Слуцкого

Чтобы лучше почувствовать разницу между Маршалианским и Хиксианским спросами, сфокусируемся на связывающем их уравнении:

$$\vec h (\vec p, \bar U) = \vec m(\vec p,  E(\vec p, \bar U)).$$

:::{dropdown} Помните ли вы условия для Дуальности?

Строго выпуклая задача + локальная ненасыщаемость.

:::

Вас, скорее всего, не учили матричному дифференциированию, но в данном случае оно работает примерно также как и обычное:

$$ \nabla \vec h(\vec p,  \bar U) = \nabla \vec m(\vec p,  \bar U) + \frac{\partial m}{\partial I} \cdot \nabla E(\vec p, \bar U) = \nabla \vec m(\vec p,  \bar U) + \frac{\partial m}{\partial I} \cdot \vec h $$

Проблема в том, что и $\frac{\partial m}{\partial I}$ и $\vec h$ это вектора длины $n$, и, поэтому, мы должны подумать, в каком порядке мы их хотим перемножить. Есть два варианта: либо мы умножаем строку $\frac{\partial m}{\partial I}$ на столбец $\vec h$, либо мы умножаем столбец $\frac{\partial m}{\partial I}$ на строку $\vec h$. Один из этих вариантов даст число, а другой матрицу. Тот вариант, который сохранит размерность объекта и будет правильным матричным дифференциированием. 

Однако, это еще не все. В зависимости от того, что идет по строкам: координаты цен или координаты товаров, формула будет выглядеть по разному. Например, если по горизонтали идут товары, то правильная форма:

$$ 
(\nabla h_x, \nabla h_y) = (\nabla m_x, \nabla m_y) + 
\begin{pmatrix} 
h_x \\
h_y
\end{pmatrix} 
\cdot (\frac{\partial m_x}{\partial I}, \frac{\partial m_y}{\partial I})
$$

Чтобы не запутаться, достаточно запомнить, что вектор $h$ в правой части уравнения это, на самом деле $\nabla E$, то есть, он относится к ценам, которые идут по вертикали.

:::{prf:definition}
Матрица $S = \nabla h$ называется **матрицей Слуцкого**, или матрицей замещения.
:::

:::{prf:property}
Если полезность дважды дифференцируема, то матрица Слуцкого симметрична, так как $S = \nabla^2 E$.
:::

### Кобб Дуглас

Есть много способов вывести матрицу Слуцкого для Кобб Дугласа, но, пожалуй, самый естественный - это сосчитать руками Гессиан функции расходов. Напомним, что

$$ \log E = U + C + \alpha \log p + \beta \log q.$$

Тогда 

$$ \frac{\partial}{\partial p} E = \frac{\alpha}{p} E, \quad \frac{\partial}{\partial q} E = \frac{\beta}{q} E $$

Дифференциируя второй раз, получаем повторную производную:

$$ \frac{\partial^2}{\partial^2 p} E = \frac{-\alpha}{p^2} E + \frac{\alpha^2}{p^2} E, \quad \frac{\partial^2}{\partial^2 q} E = \frac{-\beta}{q^2} E + \frac{\beta^2}{q^2} E$$

И, конечно, смешанную производную:

$$ \frac{\partial^2}{\partial p \partial q} E = \frac{\alpha \beta}{p q} E.$$

Наконец, можно вывести матрицу Слуцкого:

$$ S = E \cdot 
\begin{pmatrix} 
\frac{-\alpha + \alpha^2}{p^2} & \frac{\alpha \beta}{p q} \\
\frac{\alpha \beta}{p q} & \frac{-\beta +\beta^2}{q^2}
\end{pmatrix}
$$

### Зачем нужны Матрицы Слуцкого?

Считается, что Матрица Слуцкого это, в некотором смысле, четвертая модель поведения потребителя. То есть, вместо калибровки полезности или предпочтений, мы можем калибровать матрицу замещения. 

Коэффициенты матрицы Слуцкого можно переписать в терминах эластичности, дохода и долей, каждый из которых достаточно легко оценивается в данных. 

К примеру, если $s_x$ и $s_y$ это доли товаров $x, y$ в бюджете то верхний диагональный элемент матрицы Слуцкого можно оценить как:

$$ \frac{\partial h_x}{\partial p} = \frac{m_x}{p} (\varepsilon_{x,p} + \varepsilon_{x,I} \cdot s_x)$$

А диагоналъный элемент матрицы Слуцкого можно оценить как:

$$ \frac{\partial h_x}{\partial q} = \frac{m_x}{q} (\varepsilon_{x,q} + \varepsilon_{x,I} \cdot s_y)$$

Что можно дальше с этой матрицей сделать? В двух словах - проинтегрировать:

$$ h(p') - h(p) = \int_p^{p'} \frac{\partial}{\partial p} h(x) dx \approx (p'-p) \nabla h$$

Матрица Слуцкого указывает нам на приращение Хиксианского спроса. То есть, если эластичности оценены хорошо, то можно сказать, что приращение хиксианского спроса это приблизительно произведение матрицы Слуцкого на приращение цен.

Больше того, приращение функций расходов это площадь под $\nabla E$, то есть, примерно площадь трапеции (на боку) с основанием $(p'-p)$ и сторонами $h(p)$ и $h(p')$. 

$$ 
\begin{gather*}
CV = E(p', \bar U) - E(p, \bar U) = \int_p^{p'} h(x, \bar U) dx \approx\\
\approx \frac{(p'-p)(h(p')+h(p))}{2} = (p'-p)(\frac{h(p') - h(p)}{2} + h(p))
\end{gather*}
$$

То есть, $CV$ это, в линейном приближении, скалярное произведение хиксианского спроса на приращение цен, а во втором приближении значение квадратичной формы матрицы Слуцкого на векторе приращения цен, пополам, см. иллюстрацию:

:::{image} ./slutsky.png
:alt: Слуцкий
:width: 400px
:align: center
:::

Мы только что доказали чрезвычайно сложное технически, и при этом, достаточно полезное на практике свойство:

:::{prf:property} Разложение CV

Компенсирующую (но не эквивалентную) вариацию можно приблизить как:

$$CV \approx \delta p \cdot \vec h + \frac{\delta p \cdot S \cdot \delta p^T}{2}$$

при малых приращениях цен $\delta p = \vec p' - \vec p$, где $\vec h$ - действующий спрос.
:::

Я не смог его найти в учебниках, но, по моему, оно прикольное.

## Парадокс Геффена

В конце 19 века случился (очередной) кризис экономической мысли. Все, как один считали, что кривые спроса обязательно убывающие по своей цене. Это было логично, но формального доказательства никто не мог дать. Затем, именитые экономисты (такие как Маршалл) обратили внимание на так называемый "Парадокс Геффена".

Парадокс Геффена заключается в том, что для некоторых товаров, которые пользовались популярностью у бедных: картофель и дешевый хлеб; наблюдалась прямая зависимость между ценой и спросом. Похожая зависимость иногда прослеживается для спроса на рис в современном Китае.

Разрешение парадокса осуществляется за счет анализа Хиксианского спроса и матриц Слуцкого. 

### Бесконечно малый анализ

Обратим внимание еще раз на эластичность Хиксианского спроса по собственной цене, которую я назову $\varepsilon^c_{x,p}$:

$$\varepsilon^c_{x,p} = \varepsilon_{x,p} + \varepsilon_{x,I} \cdot s_{x},$$

и перепишем ее так, чтобы маршаллианский спрос был слева:

$$\varepsilon_{x,p} = \varepsilon^c_{x,p} - \varepsilon_{x,I} \cdot s_{x}.$$

Легко видеть, что если $\varepsilon_{x,I} > 0$ то, поскольку $\varepsilon^c_{x,p}$ всегда неположительный, то и $\varepsilon_{x,p}$ будет неположительный. А нам нужна положительная зависимость между $x,p$. Соответственно, можно сделать следующий вывод:

:::{prf:property} 
Нормальный товар не может объяснить парадокс Геффена.
:::

Предположим, наоборот, что товар $x$ инфериорный, то есть, это товар низкого качества, тогда $\varepsilon_{x,I} < 0$. Предположим также, что доля товара $x$ в бюджете потребителя достаточно высока, то есть, $s_{x}$ большой. Наконец, предположим, что для товара $x$ нет близкого (чистого) субститута, то есть, $\varepsilon^c_{x,p}$ близок к нулю.

Тогда может так случиться, что $\varepsilon_{x,p}$ станет положительным.

- $\varepsilon^c_{x,p}$ называется эффектом замещения
- $\varepsilon_{x,I} \cdot s_{x}$ называется эффектом дохода

Получается, что

:::{prf:property} 
Для того, чтобы объяснить парадокс Геффена, нужно иметь слабый эффект замещения, и сильный отрицательный эффект дохода.
:::

### Глобальный анализ

Анализ бесконечно малых показал, что должно случиться для того, чтобы маршаллианский спрос стал возрастать по собственной цене. 

Рассмотрим теперь большое изменение в цене. Сильный отрицательный эффект дохода означает, что при сокращении дохода, потребление товара (который мы рассматриваем) резко увеличивается. Слабый эффект замещения (он всегда отрицательный) означает, что при качении вдоль кривой безразличия, спрос меняется не сильно. 

Вместе эти два эффекта способны объяснить парадокс Геффена, см. иллюстрацию.

:::{image} ./IESE_EV.png
:alt: Эффекты дохода и замещения
:width: 400px
:align: center
:::

На этой иллюстрации, эффект дохода (IE, переход от 1 к 2) можно измерить, в точности, эквивалентной вариацией, поскольку мы остаемся на кривой безразличия, соответствующей новой полезности. Эффект замещения (SE, переход от 2 к 3) можно измерить в точности разностью между $h_x$ в старых и новых ценах, так как это качение вдоль этой кривой безразличия.

Также, можно сделать разложение в слегка другом порядке, см. иллюстрацию.

:::{image} ./IESE_CV.png
:alt: Эффекты дохода и замещения
:width: 400px
:align: center
:::

На этой иллюстрации, эффект дохода (IE, переход от 2 к 3) можно измерить, в точности, компенсирующей вариацией, поскольку мы остаемся на кривой безразличия, соответствующей старой полезности. Эффект замещения (SE, переход от 1 к 2) можно измерить в точности разностью между $h_x$ в старых и новых ценах, так как это качение вдоль этой кривой безразличия.

Получается, что в последней формулировке, если речь идет об одной цене, то

$$

IE = CV \approx \delta p \cdot \vec h + \frac{\delta p \cdot S \cdot \delta 
SE = h' - h \approx \delta p \cdot \nabla h = \delta p \cdot S

$$

p^T}{2}$$

