# Четвертая лекция, часть 2

## Матрица Слуцкого

Чтобы лучше почувствовать разницу между Маршалианским и Хиксианским спросами, сфокусируемся на связывающем их уравнении:

$$\vec h (\vec p, \bar U) = \vec m(\vec p,  E(\vec p, \bar U)).$$

:::{dropdown} Помните ли вы условия для Дуальности?

Строго выпуклая задача + локальная ненасыщаемость.

:::

Вас, скорее всего, не учили матричному дифференциированию, но в данном случае оно работает примерно также как и обычное:

$$ \nabla \vec h(\vec p,  \bar U) = \nabla \vec m(\vec p,  \bar U) + \frac{\partial m}{\partial I} \cdot \nabla E(\vec p, \bar U) = \nabla \vec m(\vec p,  \bar U) + \frac{\partial m}{\partial I} \cdot \vec h $$

Проблема в том, что и $\frac{\partial m}{\partial I}$ и $\vec h$ это вектора длины $n$, и, поэтому, мы должны подумать, в каком порядке мы их хотим перемножить. Есть два варианта: либо мы умножаем строку $\frac{\partial m}{\partial I}$ на столбец $\vec h$, либо мы умножаем столбец $\frac{\partial m}{\partial I}$ на строку $\vec h$. Один из этих вариантов даст число, а другой матрицу. Тот вариант, который сохранит размерность объекта и будет правильным матричным дифференциированием. 

Однако, это еще не все. В зависимости от того, что идет по строкам: координаты цен или координаты товаров, формула будет выглядеть по разному. Например, если по горизонтали идут товары:

$$ 
(\nabla h_x, \nabla h_y) = (\nabla m_x, \nabla m_y) + h^T \cdot  (\frac{\partial}{\partial I} m_x, \frac{\partial}{\partial I} m_y)
$$

Чтобы не запутаться, достаточно запомнить вектор $h$ в правой части уравнения это, на самом деле $\nabla E$, то есть, он относится к ценам, которые идут по вертикали.

